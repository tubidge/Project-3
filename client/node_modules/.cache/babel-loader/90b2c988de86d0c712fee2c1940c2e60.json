{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\schaa\\\\Developer\\\\uubc\\\\homework\\\\auth0loginnew\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\schaa\\\\Developer\\\\uubc\\\\homework\\\\auth0loginnew\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:\\\\Users\\\\schaa\\\\Developer\\\\uubc\\\\homework\\\\auth0loginnew\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"C:\\\\Users\\\\schaa\\\\Developer\\\\uubc\\\\homework\\\\auth0loginnew\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectWithoutProperties\";\nvar _jsxFileName = \"C:\\\\Users\\\\schaa\\\\Developer\\\\uubc\\\\homework\\\\auth0loginnew\\\\client\\\\src\\\\react-auth0-spa.js\";\nimport React, { useState, useEffect, useContext } from \"react\";\nimport createAuth0Client from \"@auth0/auth0-spa-js\";\n\nvar DEFAULT_REDIRECT_CALLBACK = function DEFAULT_REDIRECT_CALLBACK() {\n  return window.history.replaceState({}, document.title, window.location.pathname);\n};\n\nconsole.log(DEFAULT_REDIRECT_CALLBACK);\nexport var Auth0Context = React.createContext();\nexport var useAuth0 = function useAuth0() {\n  return useContext(Auth0Context);\n};\nexport var Auth0Provider = function Auth0Provider(_ref) {\n  var children = _ref.children,\n      _ref$onRedirectCallba = _ref.onRedirectCallback,\n      onRedirectCallback = _ref$onRedirectCallba === void 0 ? DEFAULT_REDIRECT_CALLBACK : _ref$onRedirectCallba,\n      initOptions = _objectWithoutProperties(_ref, [\"children\", \"onRedirectCallback\"]);\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      isAuthenticated = _useState2[0],\n      setIsAuthenticated = _useState2[1];\n\n  var _useState3 = useState(),\n      _useState4 = _slicedToArray(_useState3, 2),\n      user = _useState4[0],\n      setUser = _useState4[1];\n\n  var _useState5 = useState(),\n      _useState6 = _slicedToArray(_useState5, 2),\n      auth0Client = _useState6[0],\n      setAuth0 = _useState6[1];\n\n  var _useState7 = useState(true),\n      _useState8 = _slicedToArray(_useState7, 2),\n      loading = _useState8[0],\n      setLoading = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      popupOpen = _useState10[0],\n      setPopupOpen = _useState10[1];\n\n  useEffect(function () {\n    var initAuth0 =\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var auth0FromHook, _ref3, appState, isAuthenticated, _user;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return createAuth0Client(initOptions);\n\n              case 2:\n                auth0FromHook = _context.sent;\n                setAuth0(auth0FromHook);\n\n                if (!window.location.search.includes(\"code=\")) {\n                  _context.next = 10;\n                  break;\n                }\n\n                _context.next = 7;\n                return auth0FromHook.handleRedirectCallback();\n\n              case 7:\n                _ref3 = _context.sent;\n                appState = _ref3.appState;\n                onRedirectCallback(appState);\n\n              case 10:\n                _context.next = 12;\n                return auth0FromHook.isAuthenticated();\n\n              case 12:\n                isAuthenticated = _context.sent;\n                setIsAuthenticated(isAuthenticated);\n\n                if (!isAuthenticated) {\n                  _context.next = 19;\n                  break;\n                }\n\n                _context.next = 17;\n                return auth0FromHook.getUser();\n\n              case 17:\n                _user = _context.sent;\n                setUser(_user);\n\n              case 19:\n                setLoading(false);\n\n              case 20:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function initAuth0() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    initAuth0(); // eslint-disable-next-line\n  }, []);\n\n  var loginWithPopup =\n  /*#__PURE__*/\n  function () {\n    var _ref4 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var params,\n          user,\n          _args2 = arguments;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              params = _args2.length > 0 && _args2[0] !== undefined ? _args2[0] : {};\n              setPopupOpen(true);\n              _context2.prev = 2;\n              _context2.next = 5;\n              return auth0Client.loginWithPopup(params);\n\n            case 5:\n              _context2.next = 10;\n              break;\n\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](2);\n              console.error(_context2.t0);\n\n            case 10:\n              _context2.prev = 10;\n              setPopupOpen(false);\n              return _context2.finish(10);\n\n            case 13:\n              _context2.next = 15;\n              return auth0Client.getUser();\n\n            case 15:\n              user = _context2.sent;\n              setUser(user);\n              setIsAuthenticated(true);\n\n            case 18:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[2, 7, 10, 13]]);\n    }));\n\n    return function loginWithPopup() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var handleRedirectCallback =\n  /*#__PURE__*/\n  function () {\n    var _ref5 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee3() {\n      var user;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              setLoading(true);\n              _context3.next = 3;\n              return auth0Client.handleRedirectCallback();\n\n            case 3:\n              _context3.next = 5;\n              return auth0Client.getUser();\n\n            case 5:\n              user = _context3.sent;\n              setLoading(false);\n              setIsAuthenticated(true);\n              setUser(user);\n\n            case 9:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handleRedirectCallback() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  return React.createElement(Auth0Context.Provider, {\n    value: {\n      isAuthenticated: isAuthenticated,\n      user: user,\n      loading: loading,\n      popupOpen: popupOpen,\n      loginWithPopup: loginWithPopup,\n      handleRedirectCallback: handleRedirectCallback,\n      getIdTokenClaims: function getIdTokenClaims() {\n        return auth0Client.getIdTokenClaims.apply(auth0Client, arguments);\n      },\n      loginWithRedirect: function loginWithRedirect() {\n        return auth0Client.loginWithRedirect.apply(auth0Client, arguments);\n      },\n      getTokenSilently: function getTokenSilently() {\n        return auth0Client.getTokenSilently.apply(auth0Client, arguments);\n      },\n      getTokenWithPopup: function getTokenWithPopup() {\n        return auth0Client.getTokenWithPopup.apply(auth0Client, arguments);\n      },\n      logout: function logout() {\n        return auth0Client.logout.apply(auth0Client, arguments);\n      }\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69\n    },\n    __self: this\n  }, children);\n};","map":{"version":3,"sources":["C:\\Users\\schaa\\Developer\\uubc\\homework\\auth0loginnew\\client\\src\\react-auth0-spa.js"],"names":["React","useState","useEffect","useContext","createAuth0Client","DEFAULT_REDIRECT_CALLBACK","window","history","replaceState","document","title","location","pathname","console","log","Auth0Context","createContext","useAuth0","Auth0Provider","children","onRedirectCallback","initOptions","isAuthenticated","setIsAuthenticated","user","setUser","auth0Client","setAuth0","loading","setLoading","popupOpen","setPopupOpen","initAuth0","auth0FromHook","search","includes","handleRedirectCallback","appState","getUser","loginWithPopup","params","error","getIdTokenClaims","loginWithRedirect","getTokenSilently","getTokenWithPopup","logout"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\nimport createAuth0Client from \"@auth0/auth0-spa-js\";\n\nconst DEFAULT_REDIRECT_CALLBACK = () =>\n  window.history.replaceState({}, document.title, window.location.pathname);\nconsole.log(DEFAULT_REDIRECT_CALLBACK);\n\nexport const Auth0Context = React.createContext();\nexport const useAuth0 = () => useContext(Auth0Context);\nexport const Auth0Provider = ({\n  children,\n  onRedirectCallback = DEFAULT_REDIRECT_CALLBACK,\n  ...initOptions\n}) => {\n  const [isAuthenticated, setIsAuthenticated] = useState();\n  const [user, setUser] = useState();\n  const [auth0Client, setAuth0] = useState();\n  const [loading, setLoading] = useState(true);\n  const [popupOpen, setPopupOpen] = useState(false);\n\n  useEffect(() => {\n    const initAuth0 = async () => {\n      const auth0FromHook = await createAuth0Client(initOptions);\n      setAuth0(auth0FromHook);\n\n      if (window.location.search.includes(\"code=\")) {\n        const { appState } = await auth0FromHook.handleRedirectCallback();\n        onRedirectCallback(appState);\n      }\n\n      const isAuthenticated = await auth0FromHook.isAuthenticated();\n\n      setIsAuthenticated(isAuthenticated);\n\n      if (isAuthenticated) {\n        const user = await auth0FromHook.getUser();\n        setUser(user);\n      }\n\n      setLoading(false);\n    };\n    initAuth0();\n    // eslint-disable-next-line\n  }, []);\n\n  const loginWithPopup = async (params = {}) => {\n    setPopupOpen(true);\n    try {\n      await auth0Client.loginWithPopup(params);\n    } catch (error) {\n      console.error(error);\n    } finally {\n      setPopupOpen(false);\n    }\n    const user = await auth0Client.getUser();\n    setUser(user);\n    setIsAuthenticated(true);\n  };\n\n  const handleRedirectCallback = async () => {\n    setLoading(true);\n    await auth0Client.handleRedirectCallback();\n    const user = await auth0Client.getUser();\n    setLoading(false);\n    setIsAuthenticated(true);\n    setUser(user);\n  };\n  return (\n    <Auth0Context.Provider\n      value={{\n        isAuthenticated,\n        user,\n        loading,\n        popupOpen,\n        loginWithPopup,\n        handleRedirectCallback,\n        getIdTokenClaims: (...p) => auth0Client.getIdTokenClaims(...p),\n        loginWithRedirect: (...p) => auth0Client.loginWithRedirect(...p),\n        getTokenSilently: (...p) => auth0Client.getTokenSilently(...p),\n        getTokenWithPopup: (...p) => auth0Client.getTokenWithPopup(...p),\n        logout: (...p) => auth0Client.logout(...p)\n      }}\n    >\n      {children}\n    </Auth0Context.Provider>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}